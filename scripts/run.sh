#!/bin/bash

workers=8
saved_folder='./saved_models'
# seed=1234

# no ember and 0 1
# lr 0.1 test
# --wd 0.01 \
python train_torch.py \
    --lr 0.00001 \
    --epochs 400 \
    --batch-size 2096 \
    --optimizer 'adamw' \
    --loss_type bce \
    --warmup-epochs 40 \
    --save_dir $saved_folder \
    --workers $workers \
    --evaluate_every 5 \
    --save_every_epochs 20 \
    --early_stopping_patience 100 \
    --save 'defender/att_ember.pkl' \
    --hidden_dim 1024 1024 1024 1024 1024 1024 1024 \
    --num_heads 4 \
    --dropout_rate 0.4 \
    --att_dropout 0.1

python test.py -m 'defender/att_ember.pkl'

# python train_torch.py \
#     --lr 0.001 \
#     --epochs 200 \
#     --batch-size 2096 \
#     --wd 1e-4 \
#     --optimizer 'adamw' \
#     --loss_type auc \
#     --warmup-epochs 20 \
#     --save_dir $saved_folder \
#     --workers $workers \
#     --evaluate_every 10 \
#     --save_every_epochs 20 \
#     --early_stopping_patience 1000 \
#     --save 'defender/att_ember.pkl' \
#     --hidden_dim 256 256 256 256 256 256 \
#     --num_heads 4 \
#     --dropout_rate 0.1 \
#     --att_dropout 0.0
